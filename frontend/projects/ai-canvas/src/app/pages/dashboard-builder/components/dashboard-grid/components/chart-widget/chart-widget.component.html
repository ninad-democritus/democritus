<div class="chart-widget" (click)="onChartClick()" [class.has-data]="hasData()">
  <!-- Chart header -->
  <div class="chart-header">
    <div class="chart-title-section">
      <h3 class="chart-title">{{ dashboardItem.config.title }}</h3>
      <span class="chart-subtitle" *ngIf="hasData()">
        {{ getLastUpdated() }}
      </span>
    </div>
    
    <div class="chart-actions">
      <button class="action-btn" (click)="onRemove($event)" title="Remove chart">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Chart content -->
  <div class="chart-content">
    <!-- Error state -->
    <div class="chart-error" *ngIf="hasHydrationError()">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10" />
        <line x1="12" y1="8" x2="12" y2="12" />
        <line x1="12" y1="16" x2="12.01" y2="16" />
      </svg>
      <p class="error-title">Failed to Load Chart Data</p>
      <p class="error-message">{{ getHydrationErrorMessage() }}</p>
    </div>

    <!-- Empty data state -->
    <div class="chart-empty" *ngIf="!hasHydrationError() && hasEmptyData()">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
        <line x1="9" y1="9" x2="15" y2="15" />
        <line x1="15" y1="9" x2="9" y2="15" />
      </svg>
      <p class="empty-title">No Data Available</p>
      <p class="empty-message">The query returned no results</p>
    </div>

    <!-- Normal chart display -->
    <div
      *ngIf="!hasHydrationError() && !hasEmptyData()"
      echarts
      [options]="dashboardItem.config.echartsOptions"
      (chartInit)="onChartInit($event)"
      class="chart-container">
    </div>
  </div>

  <!-- Selection indicator -->
  <div class="selection-indicator" *ngIf="dashboardItem.isSelected">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M13 10V3L4 14h7v7l9-11h-7z" />
    </svg>
    <span>Linked to AI Chat</span>
  </div>
</div>

